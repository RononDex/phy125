# ---------------------------------------------------------------------------
# Solves the problem with a 3-dimensional resistor grid
#
# Modul:   PHY125
# Author:  Tino Heuberger
# Email:   tino.heuberger@uzh.ch
# ---------------------------------------------------------------------------

import numpy as np
import scipy.linalg as lin

RCube = [#V0  V1  V2  V3  V4  V5, V6, V7
         [ 3, -1, -1,  0, -1,  0,  0,  0] ,    #0
         [-1,  3,  0, -1,  0, -1,  0,  0] ,    #1
         [-1,  0,  3, -1,  0,  0, -1,  0] ,    #2
         [ 0, -1, -1,  3,  0,  0,  0, -1] ,    #3
         [-1,  0,  0,  0,  3, -1, -1,  0] ,    #4
         [ 0, -1,  0,  0, -1,  3,  0, -1] ,    #5
         [ 0,  0, -1,  0, -1,  0,  3, -1] ,    #6
         [ 0,  0,  0, -1,  0, -1, -1,  3]      #7
       ]

RCube2 = [ #V0  V1  V2  V3  V4  V5, V6, V7
            [ 2 + (1 / 0.55), -1 / 0.55, -1,  0, -1,  0,  0,  0] ,    #0
            [-1 / 0.55,  2 + (1 / 0.55),  0, -1,  0, -1,  0,  0] ,    #1
            [-1,  0,  3, -1,  0,  0, -1,  0] ,    #2
            [ 0, -1, -1,  3,  0,  0,  0, -1] ,    #3
            [-1,  0,  0,  0,  3, -1, -1,  0] ,    #4
            [ 0, -1,  0,  0, -1,  3,  0, -1] ,    #5
            [ 0,  0, -1,  0, -1,  0,  3, -1] ,    #6
            [ 0,  0,  0, -1,  0, -1, -1,  3]      #7
       ]
         
Rinv = np.matrix(RCube2)
I = np.array([ 1, 0, 0, 0, 0, 0, 0,-1])

V = lin.lstsq(Rinv,I)[0]  # Solve for V to minimize |Rinv V - I|^2

print ('effective R =', V[0]-V[-1])